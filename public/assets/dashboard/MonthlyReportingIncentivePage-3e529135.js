import{A as F}from"./AddButton-17ffc8d1.js";import{s as R,x as g,_ as U,a as x,u as C,L as B,l as M,r as b,o as n,c as a,g as y,b as t,d as p,h as w,e as h,m as l,v as d,y as v,i as D,j as A,t as _}from"./index-92b4f33c.js";import{d as I}from"./excelMaker-9fd49c90.js";const P=R("monthlyReportingIncentivesStore",{state:()=>({reports:[]}),getters:{filterByDate:e=>(o,i)=>(o==null||o.setHours(0),o==null||o.setMinutes(0),o==null||o.setSeconds(0),i==null||i.setHours(0),i==null||i.setMinutes(0),i==null||i.setSeconds(0),e.reports.filter(k=>{const m=new Date(k.date);return m.setHours(0),m.setMinutes(0),m.setSeconds(0),!o&&!i?!o&&!i:i?m>=o&&m<=i:m>=o}))},actions:{async initialize(){const e=await g.get("monthly-reporting-incentives");this.reports=e.data.reports},async refresh(){return this.initialize()},async create(e){const o=await g.post("monthly-reporting-incentives",e);this.reports.unshift(o.data.report)},async delete(e){await g.delete(`monthly-reporting-incentives/${e.id}`);const o=this.reports.findIndex(i=>i.id===e.id);this.reports.splice(o,1)},async update(e,o){await g.patch(`monthly-reporting-incentives/${e}`,o),this.reports[this.reports.findIndex(i=>i.id==e)]={...this.reports[this.reports.findIndex(i=>i.id==e)],...o}}}}),L={name:"MonthlyReportingIncentivesPage",data:()=>({availableAbilities:x,authStore:C(),reportsStore:P(),initializing:!1,dateRange:[],addForm:{saving:!1,case_number:"",client_name:"",warranty_status:"",collection_fees:"",sap_number:"",comment:"",damaged_position:!1},addFormErrors:{}}),methods:{deleteReport(e){this.$swal.fire({icon:"question",title:"حذف ؟"}).then(o=>{o.isConfirmed&&(e.deleting=!0,this.reportsStore.delete(e).catch(()=>{this.$swal.fire({icon:"error",title:"حدث خطأ ما.",showConfirmButton:!1})}).finally(()=>{e&&(e.deleting=!1)}))})},createReport(){this.addForm.comment||delete this.addForm.comment,this.addForm.saving=!0,this.reportsStore.create(this.addForm).then(()=>{this.$swal.fire({icon:"success",title:"تمت عملية الإضافة.",showCancelButton:!1,showConfirmButton:!1,timer:5e3}),this.addForm={saving:!1,case_number:"",client_name:"",warranty_status:"",collection_fees:"",sap_number:"",comment:"",damaged_position:!1}}).catch(e=>{this.$swal.fire({icon:"error",title:"حدث خطأ تأكد من البيانات.",showCancelButton:!1,showConfirmButton:!1,timer:5e3})}).finally(()=>this.addForm.saving=!1)},updateReport(e){this.$swal.fire({title:"جار تحديث البيانات",showCancelButton:!1,showConfirmButton:!1}),e.editMode=!1,this.reportsStore.update(e.id,e).then(()=>{this.$swal.fire({icon:"success",title:"تم التحديث بنجاح.",showCancelButton:!1,showConfirmButton:!1,timer:5e3})}).catch(()=>{this.$swal.fire({icon:"error",title:"حدث خطأ تأكد من البيانات.",showCancelButton:!1,showConfirmButton:!1,timer:5e3})})},downloadReport(){I("تقرير الحافز الشهرى",this.reportsStore.filterByDate(this.dateRange[0],this.dateRange[1]),[{column:"التاريخ والوقت",type:String,value:e=>new Date(e.date).toLocaleString(),width:30,align:"center"},{column:"رقم الحالة",type:String,value:e=>e.case_number,width:30,align:"center"},{column:"أسم العميل",type:String,value:e=>e.client_name,width:30,align:"center"},{column:"حالة الضمان",type:String,value:e=>e.warranty_status,width:30,align:"center"},{column:"التعليق",type:String,value:e=>e.comment,width:30,align:"center"},{column:"رسوم التحصيل",type:String,value:e=>e.collection_fees,width:30,align:"center"},{column:"رقم SAP",type:String,value:e=>e.sap_number,width:30,align:"center"},{column:"موقف التالف",type:String,value:e=>e.damaged_position?"✓":"",width:30,align:"center"}])}},mounted(){if(!this.authStore.can(x.monthlyReportingIncentives.index)){this.$router.push({name:"home"});return}this.initializing=!0,this.reportsStore.initialize().catch(e=>{this.$swal.fire({icon:"error",title:"حدث خطأ ما.",showConfirmButton:!1})}).finally(()=>this.initializing=!1)},components:{LoadingPage:B,LoadingComponent:M,AddButton:F}},z={class:"h-100 pb-5 overflow-auto position-relative"},$={key:1,class:"py-4"},N={class:"container-fluid"},H={class:"row"},q={class:"col-12"},E={key:0,class:"row mt-5"},j={class:"col-12 col-md-6 col-lg-3 px-lg-5 mt-2"},G={style:{direction:"ltr !important"}},J={class:"col-12 col-md-6 col-lg-9 px-lg-5 text-left mt-2"},K={class:"ico"},O=t("span",{style:{"margin-right":"7px"}}," إستخراج الى ملف اكسل ",-1),Q={class:"row mt-5"},W={class:"col-12 px-lg-5 px-0 overflow-x-auto"},X={class:"table table-borderless overflow-x-auto"},Y=t("thead",{class:"bg-color-main"},[t("tr",null,[t("th",{scope:"col",class:"bg-transparent text-white px-3"},"التاريخ"),t("th",{scope:"col",class:"bg-transparent text-white px-3"},"رقم الحالة"),t("th",{scope:"col",class:"bg-transparent text-white px-3"},"اسم العميل"),t("th",{scope:"col",class:"bg-transparent text-white px-3"},"حالة الضمان"),t("th",{scope:"col",class:"bg-transparent text-white px-3"},"التعليق"),t("th",{scope:"col",class:"bg-transparent text-white px-3"},"رسوم التحصيل"),t("th",{scope:"col",class:"bg-transparent text-white px-3"},"رقم SAP"),t("th",{scope:"col",class:"bg-transparent text-white px-3"},"موقف التالف"),t("th",{scope:"col",class:"bg-transparent text-white px-3",style:{width:"135px"}})])],-1),Z={key:0,class:"border-top"},T={class:"px-3 py-4"},ee=["value"],te={class:"px-3 py-4"},se={class:"form-group"},oe={class:"px-3 py-4"},ne={class:"form-group"},ae={class:"px-3 py-4"},le={class:"form-group"},ie={class:"px-3 py-4"},de={class:"form-group"},re={class:"px-3 py-4"},ce={class:"form-group"},pe={class:"px-3 py-4"},me={class:"form-group"},ue={class:"px-3 py-4"},he={class:"form-group"},_e={class:"px-3 py-4"},ye=["disabled"],fe={key:1},ge={key:1,class:"mt-5"},be=t("td",{colspan:"5",class:"text-center"}," لا يوجد نتائج ",-1),we=[be],ve={key:0,class:"px-3"},ke=["value"],xe={key:1,class:"px-3"},Se={key:2,class:"px-3"},Ve=["onUpdate:modelValue"],Fe={key:3,class:"px-3"},Re={key:4,class:"px-3"},Ue=["onUpdate:modelValue"],Ce={key:5,class:"px-3"},Be={key:6,class:"px-3"},Me=["onUpdate:modelValue"],De={key:7,class:"px-3"},Ae={key:8,class:"px-3"},Ie=["onUpdate:modelValue"],Pe={key:9,class:"px-3"},Le={key:10,class:"px-3"},ze=["onUpdate:modelValue"],$e={key:11,class:"px-3"},Ne={key:12,class:"px-3"},He=["onUpdate:modelValue"],qe={key:13,class:"px-3"},Ee={class:"px-3"},je=["onUpdate:modelValue","disabled"],Ge={class:"px-3"},Je=["onClick"],Ke=["onClick"],Oe={key:1},Qe=["onClick"],We={key:1},Xe={key:2,class:"border-top"},Ye={class:"px-3 py-4"},Ze=["value"],Te={class:"px-3 py-4"},et={class:"form-group"},tt={class:"px-3 py-4"},st={class:"form-group"},ot={class:"px-3 py-4"},nt={class:"form-group"},at={class:"px-3 py-4"},lt={class:"form-group"},it={class:"px-3 py-4"},dt={class:"form-group"},rt={class:"px-3 py-4"},ct={class:"form-group"},pt={class:"px-3 py-4"},mt={class:"form-group"},ut={class:"px-3 py-4"},ht=["disabled"],_t={key:1};function yt(e,o,i,k,m,c){const S=b("loading-page"),u=b("font-awesome-icon"),V=b("VueDatePicker"),f=b("loading-component");return n(),a("div",z,[e.initializing?(n(),y(S,{key:0,color:"#135ea2"})):(n(),a("div",$,[t("div",N,[t("div",H,[t("div",q,[t("h5",null,[p(u,{icon:"fa-solid fa-file-lines"}),w(" تقرير الحافز الشهرى ")])])]),e.authStore.can(e.availableAbilities.exports.fullIndex)?(n(),a("div",E,[t("div",j,[t("div",G,[p(V,{placeholder:"أختر التاريخ",modelValue:e.dateRange,"onUpdate:modelValue":o[0]||(o[0]=s=>e.dateRange=s),"enable-time-picker":!1,range:""},null,8,["modelValue"])])]),t("div",J,[t("button",{class:"btn btn-excel color-main",onClick:o[1]||(o[1]=(...s)=>c.downloadReport&&c.downloadReport(...s))},[t("span",K,[p(u,{icon:"fa-solid fa-file-excel"})]),O])])])):h("",!0),t("div",Q,[t("div",W,[t("table",X,[Y,t("tbody",null,[e.authStore.can(e.availableAbilities.monthlyReportingIncentives.create)&&e.reportsStore.filterByDate(e.dateRange[0],e.dateRange[1]).length>0?(n(),a("tr",Z,[t("td",T,[t("input",{type:"text",class:"form-control",disabled:"true",value:new Date().toLocaleDateString(),style:{cursor:"not-allowed"}},null,8,ee)]),t("td",te,[t("div",se,[l(t("input",{type:"text",class:"form-control",placeholder:"رقم الحالة...","onUpdate:modelValue":o[2]||(o[2]=s=>e.addForm.case_number=s)},null,512),[[d,e.addForm.case_number]])])]),t("td",oe,[t("div",ne,[l(t("input",{type:"text",class:"form-control",placeholder:"أسم العميل...","onUpdate:modelValue":o[3]||(o[3]=s=>e.addForm.client_name=s)},null,512),[[d,e.addForm.client_name]])])]),t("td",ae,[t("div",le,[l(t("input",{type:"text",class:"form-control",placeholder:"حالة الضمان...","onUpdate:modelValue":o[4]||(o[4]=s=>e.addForm.warranty_status=s)},null,512),[[d,e.addForm.warranty_status]])])]),t("td",ie,[t("div",de,[l(t("input",{type:"text",class:"form-control",placeholder:"التعليق...","onUpdate:modelValue":o[5]||(o[5]=s=>e.addForm.comment=s)},null,512),[[d,e.addForm.comment]])])]),t("td",re,[t("div",ce,[l(t("input",{type:"number",class:"form-control",placeholder:"رسوم التحصيل...","onUpdate:modelValue":o[6]||(o[6]=s=>e.addForm.collection_fees=s)},null,512),[[d,e.addForm.collection_fees]])])]),t("td",pe,[t("div",me,[l(t("input",{type:"text",class:"form-control",placeholder:"رقم SAP...","onUpdate:modelValue":o[7]||(o[7]=s=>e.addForm.sap_number=s)},null,512),[[d,e.addForm.sap_number]])])]),t("td",ue,[t("div",he,[l(t("input",{type:"checkbox",class:"form-check-input",style:{width:"23px",height:"23px"},"onUpdate:modelValue":o[8]||(o[8]=s=>e.addForm.damaged_position=s)},null,512),[[v,e.addForm.damaged_position]])])]),t("td",_e,[t("button",{class:"btn btn-primary",onClick:o[9]||(o[9]=(...s)=>c.createReport&&c.createReport(...s)),disabled:e.addForm.saving||!e.addForm.case_number||!e.addForm.client_name||!e.addForm.warranty_status||!e.addForm.collection_fees||!e.addForm.sap_number},[e.addForm.saving?(n(),y(f,{key:0,width:"20px"})):(n(),a("span",fe,[p(u,{icon:"fa-solid fa-plus"}),w(" إضافة ")]))],8,ye)])])):h("",!0),e.reportsStore.filterByDate(e.dateRange[0],e.dateRange[1]).length==0?(n(),a("tr",ge,we)):h("",!0),(n(!0),a(D,null,A(e.reportsStore.filterByDate(e.dateRange[0],e.dateRange[1]),s=>(n(),a("tr",{key:s.id},[s.editMode?(n(),a("td",ve,[t("input",{type:"text",class:"form-control",value:new Date(s.date).toLocaleString(),disabled:"true"},null,8,ke)])):(n(),a("td",xe,_(new Date(s.date).toLocaleDateString()),1)),s.editMode?(n(),a("td",Se,[l(t("input",{type:"text",class:"form-control",placeholder:"رقم الحالة...","onUpdate:modelValue":r=>s.case_number=r},null,8,Ve),[[d,s.case_number]])])):(n(),a("td",Fe,_(s.case_number),1)),s.editMode?(n(),a("td",Re,[l(t("input",{type:"text",class:"form-control",placeholder:"أسم العميل...","onUpdate:modelValue":r=>s.client_name=r},null,8,Ue),[[d,s.client_name]])])):(n(),a("td",Ce,_(s.client_name),1)),s.editMode?(n(),a("td",Be,[l(t("input",{type:"text",class:"form-control",placeholder:"حالة الضمان...","onUpdate:modelValue":r=>s.warranty_status=r},null,8,Me),[[d,s.warranty_status]])])):(n(),a("td",De,_(s.warranty_status),1)),s.editMode?(n(),a("td",Ae,[l(t("input",{type:"text",class:"form-control",placeholder:"التعليق...","onUpdate:modelValue":r=>s.comment=r},null,8,Ie),[[d,s.comment]])])):(n(),a("td",Pe,_(s.comment??"لا يوجد التعليق"),1)),s.editMode?(n(),a("td",Le,[l(t("input",{type:"number",class:"form-control",min:"0","onUpdate:modelValue":r=>s.collection_fees=r},null,8,ze),[[d,s.collection_fees]])])):(n(),a("td",$e,_(s.collection_fees)+"ج ",1)),s.editMode?(n(),a("td",Ne,[l(t("input",{type:"text",class:"form-control",placeholder:"رقم SAP...","onUpdate:modelValue":r=>s.sap_number=r},null,8,He),[[d,s.sap_number]])])):(n(),a("td",qe,_(s.sap_number),1)),t("td",Ee,[l(t("input",{type:"checkbox",class:"form-check-input",style:{width:"23px",height:"23px"},"onUpdate:modelValue":r=>s.damaged_position=r,disabled:!s.editMode},null,8,je),[[v,s.damaged_position]])]),t("td",Ge,[e.authStore.can(e.availableAbilities.monthlyReportingIncentives.update)&&!s.editMode?(n(),a("button",{key:0,class:"btn btn-primary mx-1 my-1",onClick:()=>s.editMode=!0},[t("span",null,[p(u,{icon:"fa-solid fa-pen-to-square"})])],8,Je)):h("",!0),e.authStore.can(e.availableAbilities.monthlyReportingIncentives.update)&&s.editMode?(n(),a("button",{key:1,class:"btn btn-primary mx-1 my-1",onClick:()=>c.updateReport(s)},[s.updating?(n(),y(f,{key:0,width:"20px"})):(n(),a("span",Oe,[p(u,{icon:"fa-solid fa-floppy-disk"}),w(" حفظ ")]))],8,Ke)):h("",!0),e.authStore.can(e.availableAbilities.monthlyReportingIncentives.delete)&&!s.editMode?(n(),a("button",{key:2,class:"btn btn-danger mx-1 my-1",onClick:()=>c.deleteReport(s)},[s.deleting?(n(),y(f,{key:0,width:"20px"})):(n(),a("span",We,[p(u,{icon:"fa-solid fa-trash"})]))],8,Qe)):h("",!0)])]))),128)),e.authStore.can(e.availableAbilities.monthlyReportingIncentives.create)?(n(),a("tr",Xe,[t("td",Ye,[t("input",{type:"text",class:"form-control",disabled:"true",value:new Date().toLocaleDateString(),style:{cursor:"not-allowed"}},null,8,Ze)]),t("td",Te,[t("div",et,[l(t("input",{type:"text",class:"form-control",placeholder:"رقم الحالة...","onUpdate:modelValue":o[10]||(o[10]=s=>e.addForm.case_number=s)},null,512),[[d,e.addForm.case_number]])])]),t("td",tt,[t("div",st,[l(t("input",{type:"text",class:"form-control",placeholder:"أسم العميل...","onUpdate:modelValue":o[11]||(o[11]=s=>e.addForm.client_name=s)},null,512),[[d,e.addForm.client_name]])])]),t("td",ot,[t("div",nt,[l(t("input",{type:"text",class:"form-control",placeholder:"حالة الضمان...","onUpdate:modelValue":o[12]||(o[12]=s=>e.addForm.warranty_status=s)},null,512),[[d,e.addForm.warranty_status]])])]),t("td",at,[t("div",lt,[l(t("input",{type:"text",class:"form-control",placeholder:"التعليق...","onUpdate:modelValue":o[13]||(o[13]=s=>e.addForm.comment=s)},null,512),[[d,e.addForm.comment]])])]),t("td",it,[t("div",dt,[l(t("input",{type:"number",class:"form-control",placeholder:"رسوم التحصيل...","onUpdate:modelValue":o[14]||(o[14]=s=>e.addForm.collection_fees=s)},null,512),[[d,e.addForm.collection_fees]])])]),t("td",rt,[t("div",ct,[l(t("input",{type:"text",class:"form-control",placeholder:"رقم SAP...","onUpdate:modelValue":o[15]||(o[15]=s=>e.addForm.sap_number=s)},null,512),[[d,e.addForm.sap_number]])])]),t("td",pt,[t("div",mt,[l(t("input",{type:"checkbox",class:"form-check-input",style:{width:"23px",height:"23px"},"onUpdate:modelValue":o[16]||(o[16]=s=>e.addForm.damaged_position=s)},null,512),[[v,e.addForm.damaged_position]])])]),t("td",ut,[t("button",{class:"btn btn-primary",onClick:o[17]||(o[17]=(...s)=>c.createReport&&c.createReport(...s)),disabled:e.addForm.saving||!e.addForm.case_number||!e.addForm.client_name||!e.addForm.warranty_status||!e.addForm.collection_fees||!e.addForm.sap_number},[e.addForm.saving?(n(),y(f,{key:0,width:"20px"})):(n(),a("span",_t,[p(u,{icon:"fa-solid fa-plus"}),w(" إضافة ")]))],8,ht)])])):h("",!0)])])])])])]))])}const wt=U(L,[["render",yt]]);export{wt as default};
