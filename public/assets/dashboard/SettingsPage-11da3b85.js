import{v as e}from"./validationMsgs-754c5d91.js";import{_ as v,u as D,l as g,r as w,o as n,c as m,b as a,d as p,m as r,v as i,q as l,t as d,e as P,g as h,h as _}from"./index-f80301b3.js";const y={name:"SettingsPage",data:()=>({validationMsgs:e,authStore:D(),updatingContactData:!1,contactData:{f_name:"",l_name:"",email:"",username:""},contactDataErrors:{},passwords:{oldPassword:"",newPassword:""},updatingPassword:!1,passwordErrors:{}}),watch:{contactData:{handler(s){/^[a-zA-Z\u0621-\u064A]{2,20}$/.test(s.f_name)?delete this.contactDataErrors.f_name:this.contactDataErrors.f_name=e.fName,/^[a-zA-Z\u0621-\u064A]{2,20}$/.test(s.l_name)?delete this.contactDataErrors.l_name:this.contactDataErrors.l_name=e.lName,/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(s.email)?delete this.contactDataErrors.email:this.contactDataErrors.email=e.email,/^[a-zA-Z0-9\.]{3,50}$/.test(s.username)?delete this.contactDataErrors.username:this.contactDataErrors.username=e.username},deep:!0},passwords:{handler(s){!/^.{8,100}$/.test(s.newPassword)&&s.newPassword?this.passwordErrors.newPassword=e.password:delete this.passwordErrors.newPassword},deep:!0}},methods:{updateContactInfo(){this.updatingContactData=!0,this.authStore.update({f_name:this.contactData.f_name,l_name:this.contactData.l_name,email:this.contactData.email,username:this.contactData.username}).then(()=>{this.$swal.fire({icon:"success",title:"تم التعديل.",showCancelButton:!1})}).catch(s=>{s.response.status===400?(s.response.data.errors.email&&s.response.data.errors.email[0]==="The email has already been taken."&&this.$swal.fire({icon:"error",title:e.emailUnique,showConfirmButton:!1,cancelButtonText:"مراجعة"}),s.response.data.errors.username&&s.response.data.errors.username[0]==="The username has already been taken."&&this.$swal.fire({icon:"error",title:e.usernameUnique,showConfirmButton:!1,cancelButtonText:"مراجعة"})):this.$swal.fire({icon:"error",title:"خطأ غير معروف تأكد من اتصالك بالانترنت.",showConfirmButton:!1,cancelButtonText:"مراجعة"})}).finally(()=>this.updatingContactData=!1)},updatePassword(){this.updatingPassword=!0,this.authStore.update({password:this.passwords.newPassword,old_password:this.passwords.oldPassword}).then(()=>{this.$swal.fire({icon:"success",title:"تم التعديل.",html:"برجاء تسجيل الدخول مرة اخرى.",showCancelButton:!1})}).catch(s=>{s.response.status===403&&(this.passwordErrors.oldPassword=e.oldPassword)}).finally(()=>this.updatingPassword=!1)}},mounted(){const{user:s}=this.authStore;this.contactData.f_name=s.f_name,this.contactData.l_name=s.l_name,this.contactData.email=s.email,this.contactData.username=s.username},components:{LoadingComponent:g}},b={class:"settings-page h-100 pb-5 overflow-auto position-relative py-4"},E={class:"container"},k={class:"row mb-4"},C={class:"col-12"},$=a("span",null," إعدادات الحساب ",-1),B={key:0,class:"row"},V={class:"col-12 col-md-6 form-group my-2"},A=a("label",{for:"f_name"}," الإسم الاول ",-1),S={class:"invalid-feedback"},U={class:"col-12 col-md-6 form-group my-2"},T=a("label",{for:"l_name"}," الإسم العائلة ",-1),z={class:"invalid-feedback"},N={class:"row"},Z={class:"col-12 form-group my-2"},M=a("label",{for:"email"},"البريد الالكترونى",-1),q={class:"invalid-feedback"},I={class:"col-12 form-group my-2"},L=a("label",{for:"username"},"أسم المستخدم",-1),j={class:"invalid-feedback"},F={class:"col-12 my-2 text-left"},G={key:1},H={class:"row"},J=a("div",{class:"col-12 mt-5 mb-2"},[a("h6",null," تغيير كلمة السر ")],-1),K={class:"col-12 col-md-6 form-group my-2"},O=a("label",{for:"old-password"}," كلمة السر الحالية ",-1),Q={class:"invalid-feedback"},R={class:"col-12 col-md-6 form-group my-2"},W=a("label",{for:"new-password"}," كلمة السر الجديدة ",-1),X={class:"invalid-feedback"},Y={class:"col-12 my-2 text-left"},x=["disabled"],ss={key:1};function as(s,t,ts,os,es,c){const u=w("font-awesome-icon"),f=w("loading-component");return n(),m("div",b,[a("div",E,[a("div",k,[a("div",C,[a("h5",null,[p(u,{icon:"fa-solid fa-user-gear"}),$])])]),s.authStore.isAdmin?(n(),m("div",B,[a("div",V,[A,r(a("input",{type:"text",id:"f_name",class:l(`form-control ${s.contactDataErrors.f_name?"is-invalid":s.contactData.f_name.length>0?"is-valid":""}`),"onUpdate:modelValue":t[0]||(t[0]=o=>s.contactData.f_name=o)},null,2),[[i,s.contactData.f_name]]),a("div",S,d(s.contactDataErrors.f_name),1)]),a("div",U,[T,r(a("input",{type:"text",id:"l_name",class:l(["form-control",`form-control ${s.contactDataErrors.l_name?"is-invalid":s.contactData.l_name.length>0?"is-valid":""}`]),"onUpdate:modelValue":t[1]||(t[1]=o=>s.contactData.l_name=o)},null,2),[[i,s.contactData.l_name]]),a("div",z,d(s.contactDataErrors.l_name),1)])])):P("",!0),a("div",N,[a("div",Z,[M,r(a("input",{type:"email",id:"email",class:l(["form-control",`form-control ${s.contactDataErrors.email?"is-invalid":s.contactData.email.length>0?"is-valid":""}`]),"onUpdate:modelValue":t[2]||(t[2]=o=>s.contactData.email=o)},null,2),[[i,s.contactData.email]]),a("div",q,d(s.contactDataErrors.email),1)]),a("div",I,[L,r(a("input",{type:"text",id:"username",class:l(["form-control",`form-control ${s.contactDataErrors.username?"is-invalid":s.contactData.username.length>0?"is-valid":""}`]),"onUpdate:modelValue":t[3]||(t[3]=o=>s.contactData.username=o)},null,2),[[i,s.contactData.username]]),a("div",j,d(s.contactDataErrors.username),1)]),a("div",F,[a("button",{class:"btn btn-success",onClick:t[4]||(t[4]=(...o)=>c.updateContactInfo&&c.updateContactInfo(...o))},[s.updatingContactData?(n(),h(f,{key:0,width:"20px"})):(n(),m("span",G,[p(u,{icon:"fa-solid fa-floppy-disk"}),_(" حفظ ")]))])])]),a("div",H,[J,a("div",K,[O,r(a("input",{type:"password",id:"old-password",class:l(["form-control",`form-control ${s.passwordErrors.oldPassword?"is-invalid":s.passwords.oldPassword.length>0?"is-valid":""}`]),"onUpdate:modelValue":t[5]||(t[5]=o=>s.passwords.oldPassword=o)},null,2),[[i,s.passwords.oldPassword]]),a("div",Q,d(s.validationMsgs.oldPassword),1)]),a("div",R,[W,r(a("input",{type:"password",id:"new-password",class:l(["form-control",`form-control ${s.passwordErrors.newPassword?"is-invalid":s.passwords.newPassword.length>0?"is-valid":""}`]),"onUpdate:modelValue":t[6]||(t[6]=o=>s.passwords.newPassword=o)},null,2),[[i,s.passwords.newPassword]]),a("div",X,d(s.validationMsgs.password),1)]),a("div",Y,[a("button",{class:"btn btn-success",onClick:t[7]||(t[7]=(...o)=>c.updatePassword&&c.updatePassword(...o)),disabled:!s.passwords.oldPassword||!s.passwords.newPassword||s.passwordErrors.newPassword},[s.updatingPassword?(n(),h(f,{key:0,width:"20px"})):(n(),m("span",ss,[p(u,{icon:"fa-solid fa-floppy-disk"}),_(" حفظ ")]))],8,x)])])])])}const is=v(y,[["render",as]]);export{is as default};
