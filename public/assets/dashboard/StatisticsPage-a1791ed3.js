import{_ as m,u as p,a as u,L as _,r as l,o as e,c as i,g as v,b as o,d as h,h as f,i as S,j as y,k as g,t as r}from"./index-f80301b3.js";import{u as x}from"./imports-db7e637d.js";import{u as w}from"./exports-bcee0f95.js";import{d as H}from"./excelMaker-e2aa0e77.js";const b={name:"StatisticsPage",data:()=>({authStore:p(),importsStore:x(),exportsStore:w(),importsStoreInitialized:!1,exportsStoreInitialized:!1,monthsHistory:{}}),computed:{months(){return Object.keys(this.monthsHistory)},getArrayData(){return Object.keys(this.monthsHistory).map(t=>({month:t,imports:this.monthsHistory[t].imports,exports:this.monthsHistory[t].exports,total:this.monthsHistory[t].imports-this.monthsHistory[t].exports}))}},methods:{downloadReport(){H("أحصائيات نيو الكترونيك",this.getArrayData,[{column:"الشهر",type:String,value:t=>t.month,width:20,align:"center"},{column:"مجموع الإيرادات",type:String,value:t=>t.imports,width:20,align:"center"},{column:"مجموع المصروفات",type:String,value:t=>t.exports,width:20,align:"center"},{column:"الإجمالى",type:String,value:t=>t.total,width:20,align:"center"}])}},mounted(){if(!this.authStore.can(u.statistics.show)){this.$router.push({name:"home"});return}this.importsStore.initialize().then(()=>{this.importsStoreInitialized=!0,Object.keys(this.importsStore.sumGroupByMonth).forEach(t=>{this.monthsHistory[t]?this.monthsHistory[t].imports=this.importsStore.sumGroupByMonth[t]:this.monthsHistory[t]={imports:this.importsStore.sumGroupByMonth[t]}})}).catch(t=>{this.$swal.fire({icon:"error",title:"حدث خطأ اثناء جلب البيانات.",showConfirmButton:!1,cancelButoonText:"موافق"})}),this.exportsStore.initialize().then(()=>{this.exportsStoreInitialized=!0,Object.keys(this.exportsStore.sumGroupByMonth).forEach(t=>{this.monthsHistory[t]?this.monthsHistory[t].exports=this.exportsStore.sumGroupByMonth[t]:this.monthsHistory[t]={exports:this.exportsStore.sumGroupByMonth[t]}})}).catch(t=>{this.$swal.fire({icon:"error",title:"حدث خطأ اثناء جلب البيانات.",showConfirmButton:!1,cancelButoonText:"موافق"})})},components:{LoadingPage:_}},B={class:"statistics-page h-100 pb-5 overflow-auto position-relative"},z={key:1,class:"py-4"},I={class:"container-fluid text-center"},G={class:"row"},M={class:"col-12"},j={class:"row mt-5"},A={class:"col-12 text-right"},C={class:"ico"},E=o("span",{style:{"margin-right":"7px"}}," إستخراج الى ملف اكسل ",-1),N=g('<div class="row mt-5 bg-color-main text-white"><div class="col-3 head"> الشهر </div><div class="col-3 head"> مجموع الإيرادات </div><div class="col-3 head"> مجموع المصروفات </div><div class="col-3 head"> الأجمالى </div></div>',1),O={class:"col-3"},T={class:"col-3"},V={class:"col-3"},$={class:"col-3"};function D(t,n,L,P,R,a){const d=l("loading-page"),c=l("font-awesome-icon");return e(),i("div",B,[!t.importsStoreInitialized||!t.exportsStoreInitialized?(e(),v(d,{key:0,color:"#135ea2"})):(e(),i("div",z,[o("div",I,[o("div",G,[o("div",M,[o("h5",null,[h(c,{icon:"fa-solid fa-chart-line"}),f(" الأحصائيات ")])])]),o("div",j,[o("div",A,[o("button",{class:"btn btn-excel color-main",onClick:n[0]||(n[0]=(...s)=>a.downloadReport&&a.downloadReport(...s))},[o("span",C,[h(c,{icon:"fa-solid fa-file-excel"})]),E])])]),N,(e(!0),i(S,null,y(a.months,s=>(e(),i("div",{class:"row border-bottom py-2",key:s},[o("div",O,r(s),1),o("div",T,r(t.monthsHistory[s].imports)+"ج ",1),o("div",V,r(t.monthsHistory[s].exports)+"ج ",1),o("div",$,r(t.monthsHistory[s].imports-t.monthsHistory[s].exports)+"ج ",1)]))),128))])]))])}const K=m(b,[["render",D]]);export{K as default};
