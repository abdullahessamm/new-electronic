import{_ as v,u as _,a as b,l as g,r as l,o as t,c as m,b as s,d,h as p,m as c,v as f,q as u,t as h,g as E}from"./index-f80301b3.js";import{v as i}from"./validationMsgs-754c5d91.js";import{u as F}from"./employees-dded7178.js";const w={name:"UserAddPage",data:()=>({authStore:_(),empsStore:F(),saving:!1,availableAbilities:b,empForm:{name:"",salary:""},formErrors:{}}),computed:{formHasErrors(){return Object.keys(this.formErrors).length>0},formHasEmptyFields(){return!this.empForm.name||!this.empForm.salary}},methods:{saveEmployee(){this.saving=!0,this.empsStore.createEmp({salary:this.empForm.salary,name:this.empForm.name}).then(()=>{this.$swal.fire({icon:"success",title:"تم إنشاء موظف جديد.",showConfirmButton:!0}),this.$router.push({name:"employees.index"})}).catch(e=>{e.response.status===400?this.$swal.fire({icon:"error",title:"يوجد خطأ بالبيانات.",showConfirmButton:!1,cancelButtonText:"مراجعة"}):this.$swal.fire({icon:"error",title:"يوجد خطأ بالشبكة.",showConfirmButton:!1,cancelButtonText:"إغلاق"})}).finally(()=>this.saving=!1)}},watch:{empForm:{handler(e){!/^[a-zA-Z\u0621-\u064A\ ]{2,100}$/.test(e.name)&&e.name?this.formErrors.name=i.name:delete this.formErrors.name,e.salary?parseFloat(e.salary)>=999999.99||parseFloat(e.salary)<1?this.formErrors.salary=i.salary:delete this.formErrors.salary:this.formErrors.salary=i.salary},deep:!0}},mounted(){this.authStore.can(this.availableAbilities.employees.create)||this.$router.push({name:"home"})},components:{LoadingComponent:g}},k={class:"user-add-page position-absolute top-0 w-100 h-100 z-2 bg-body overflow-y-auto"},B={class:"container my-3"},$={class:"row mb-4"},A={class:"col-12"},C={class:"row"},S={class:"form-group col-12 mb-3"},V=s("label",{for:"name-input"}," الاسم بالكامل ",-1),H={class:"invalid-feedback"},T={class:"form-group col-12 mb-3"},x=s("label",{for:"name-input"}," الراتب ",-1),z={class:"invalid-feedback"},N={class:"save-btn px-3 pb-4 text-left"},U=["disabled"],D={key:1};function M(e,o,P,j,q,r){const n=l("font-awesome-icon"),y=l("loading-component");return t(),m("div",k,[s("div",B,[s("div",$,[s("div",A,[s("h5",null,[d(n,{icon:"fa-solid fa-user-plus"}),p(" إضافة موظف ")])])]),s("div",C,[s("div",S,[V,c(s("input",{type:"text",id:"name-input",class:u(`form-control mt-1 ${e.formErrors.name?"is-invalid":e.empForm.name.length>0?"is-valid":""}`),"onUpdate:modelValue":o[0]||(o[0]=a=>e.empForm.name=a)},null,2),[[f,e.empForm.name]]),s("div",H,h(e.formErrors.name),1)]),s("div",T,[x,c(s("input",{type:"number",id:"name-input",min:"0",max:"999999.99",class:u(`form-control mt-1 ${e.formErrors.salary?"is-invalid":e.empForm.salary.length>0?"is-valid":""}`),"onUpdate:modelValue":o[1]||(o[1]=a=>e.empForm.salary=a)},null,2),[[f,e.empForm.salary]]),s("div",z,h(e.formErrors.salary),1)])])]),s("div",N,[s("button",{onClick:o[2]||(o[2]=(...a)=>r.saveEmployee&&r.saveEmployee(...a)),class:"btn btn-success px-3 py-2",disabled:r.formHasErrors||r.formHasEmptyFields||e.saving},[e.saving?(t(),E(y,{key:0,width:"20px"})):(t(),m("span",D,[d(n,{icon:"fa-solid fa-floppy-disk",style:{"margin-left":"5px"}}),p(" حفظ ")]))],8,U)])])}const G=v(w,[["render",M]]);export{G as default};
